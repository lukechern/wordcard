# 更新日志

本项目遵循 [语义化版本](https://semver.org/lang/zh-CN/) 规范。

## [6.6.1] - 2025-08-02

### 功能改进 💡
- **更新统计图表关于文章的数据**: 优化了仪表盘中关于文章数据的统计图表显示
- **修复几个交互bug**: 修复了用户在使用过程中遇到的几个交互问题，提升了应用稳定性

## [6.6.0] - 2025-08-02

### 新增功能 ✨
- **局域网MySQL数据库支持**: 实现单词数据和文章数据一键上传到局域网MySQL数据库，或从局域网下载到app，方便用户在不同设备间同步学习数据

## [6.5.0] - 2025-08-01

### 新增功能 ✨
- **CloudFlare云端数据备份**: 单词和文章数据可直接备份到CloudFlare云端D1数据库，支持数据的云端存储和同步
- **数据下载还原功能**: 支持从CloudFlare云端D1数据库下载备份数据，并可还原到本地，确保数据安全

### 界面优化 🎨
- **管理配置页面UI优化**: 优化了数据管理页面的用户界面，提升操作体验和视觉效果
- **配置页面交互改进**: 改进了配置页面的交互逻辑，使功能更加直观易用

## [6.3.1] - 2025-07-31

### 新增功能 ✨
- **PC端Web导入、导出AI创作文章历史数据的功能**: 支持通过局域网在PC端Web界面导入和导出AI创作的文章历史数据
- **手机app中配置-数据管理栏目导入、导出AI创作文章历史数据的功能**: 在手机应用的配置页面数据管理栏目中，新增了AI创作文章历史数据的导入和导出功能

### 功能改进 💡
- **文章详情页TTS朗读优化**: 在文章详情页面，如果用户点击了朗读按钮开始朗读文章，这时触发返回文章列表页操作时，会先中断TTS朗读再返回文章列表页，提升用户体验
- **修复文章详情页边缘滑动返回TTS停止问题**: 修复了在文章详情页面通过边缘滑动返回时无法正确停止TTS朗读的问题，现在无论通过顶部返回按钮还是边缘滑动返回，都能正确停止TTS朗读
- **优化文章详情页返回处理逻辑**: 优化了文章详情页的返回处理逻辑，确保在任何情况下都能正确停止TTS朗读再执行返回操作，提升了用户体验

## [6.2.0] - 2025-07-30

### 新增功能 ✨
- **文章列表滚动位置记录**: 从文章列表页进入文章详情页前自动记录当前滚动位置，返回时精确还原到之前的阅读位置
- **边缘滑动返回功能**: 在文章详情页支持从屏幕两侧向中间滑动手指返回文章列表页，操作更加便捷自然
- **智能位置恢复**: 支持分页加载、搜索模式等多种场景下的滚动位置保存和恢复，确保用户阅读体验的连续性

### 用户体验优化 💡
- **无缝阅读体验**: 解决了从详情页返回列表页时滚动位置丢失的问题，用户可以从上次阅读的位置继续浏览
- **手势操作增强**: 文章详情页新增边缘滑动手势，提供更直观的返回操作方式
- **多场景适配**: 滚动位置记录功能完美适配文章搜索、分页加载等各种使用场景

### 技术改进 🔧
- **全局单例管理**: 采用全局单例模式管理滚动位置，确保页面切换时数据不丢失
- **状态管理优化**: 完善了文章列表和详情页之间的状态传递机制，确保位置信息准确同步
- **性能优化**: 优化滚动位置恢复的时序控制，确保列表完全渲染后再进行位置恢复

### 修复问题 🐛
- **滚动位置丢失**: 修复了从文章详情页返回列表页时滚动位置重置到顶部的问题
- **状态同步错误**: 修复了页面切换时状态管理器实例被重新创建导致数据丢失的问题
- **重复恢复逻辑**: 修复了多个组件中存在重复滚动位置恢复逻辑导致的冲突问题

## [6.1.0] - 2025-07-30

### 用户体验优化 💡
- **智能生成文章状态提示优化**: 将"正在生成文章"改为更友好的"[API引擎名]写作中，请稍候…"，动态显示当前使用的AI引擎名称
- **文章生成进度显示改进**: 优化智能生成文章卡片的状态信息，提供更清晰的进度反馈和用户引导

### 程序健壮性增强 🔧
- **文章标题获取优化**: 修复智能生成文章后无法正确获取标题的问题，增加300ms延时确保数据完全更新
- **重试机制完善**: 为文章标题获取添加多次重试机制（最多8次），递增延时策略确保数据同步完成
- **异常处理增强**: 完善文章生成过程中的异常处理机制，提升应用稳定性

### 内部结构优化 🏗️
- **API请求参数优化**: 针对文章生成请求优化温度参数(temperature=0.9)和创造性参数，提升生成内容的随机性和创造性
- **数据库访问优化**: 改进ArticleDetailHandler的数据获取逻辑，支持直接从数据库获取完整文章列表用于准确统计
- **协程处理优化**: 优化异步数据处理流程，确保UI响应性和数据一致性

### 已知bug修复 🐛
- **智能生成卡片按钮失效**: 修复拆分重构后智能生成文章卡片中按钮点击无响应的问题，恢复完整的文章生成流程
- **文章列表刷新问题**: 修复文章生成成功后新文章不出现在列表中的问题，确保分页和非分页模式都能正确刷新
- **引用数量统计错误**: 修复文章详情页关键词引用数量不变化的问题，确保统计数据实时更新到单词本数据库
- **编译错误修复**: 修复协程导入缺失和suspend函数调用相关的编译错误

### 技术改进 ⚡
- **创造性参数增强**: 为文章生成添加top_p、frequency_penalty、presence_penalty等参数，显著提升内容创造性
- **时间戳验证机制**: 添加生成时间戳记录和验证，确保获取的是正确的新生成文章而非历史文章
- **状态管理完善**: 优化文章生成状态管理，确保UI状态与后台处理进度完全同步

## [6.0.0] - 2025-07-28

### 新增功能 ✨
- **AI情景文章生成**: 基于单词本中的单词，AI自动生成情景文章，帮助用户在语境中深入学习单词
- **读文章栏目**: 新增独立的"读文章"栏目，专门承载AI生成的情景文章功能
- **文章收藏管理**: 支持收藏喜欢的文章，方便日后复习和查阅
- **文章搜索功能**: 提供文章搜索功能，快速查找已生成的文章
- **文章管理功能**: 支持对生成的文章进行查看、收藏、删除等管理操作

## [5.3.0] - 2025-07-27

### 功能改进 💡
- **API配置界面优化**: 在双路翻译API配置界面中，Radio按钮和测试按钮现在会显示实际的API名称，而不是默认的"翻译API(一)"和"翻译API(二)"
- **安全性增强**: 增强了API Key的安全存储机制，并优化了相关错误处理逻辑

### 界面优化 🎨
- **帮助页面优化**: 调整了帮助页面的滚动条样式，提供更好的视觉体验
- **帮助页面重构**: 重构了帮助页面以支持加载外部内容，提升灵活性

### 技术改进 🔧
- **API服务重构**: 重构了OpenAiApiService_7ree类，优化了代码结构和可维护性

## [5.2.0] - 2025-07-26

### 技术改进 🔧
- **MainActivity 重构**: 将庞大的 MainActivity 拆分为多个专门的管理类，提升代码可维护性
  - 创建 `AppInitializer_7ree.kt` 处理应用初始化逻辑
  - 创建 `TtsManager_7ree.kt` 管理文本到语音功能
  - 创建 `IntentHandler_7ree.kt` 处理来自小组件和其他来源的 Intent
  - 创建 `BackPressHandler_7ree.kt` 处理返回键的双击退出功能
- **代码模块化**: 通过拆分 MainActivity，使代码结构更加清晰，便于后期维护和升级

## [5.1.0] - 2025-07-26

### 界面优化 🎨
- **自定义滚动条**: 为单词本历史屏幕添加自定义滚动条，与帮助页面样式一致
- **布局调整**: 调整历史屏幕主内容区域的填充，为滚动条留出空间
- **组件优化**: 优化搜索栏组件和筛选侧边菜单的布局

## [5.0.0] - 2025-07-25

### 新增功能 ✨
- **双路API大语言模型引擎**: 支持可自选的双路API大语言模型引擎，用户可以在两个不同的API之间切换使用
- **API配置优化**: 新增API名称配置选项，支持自定义API提供商名称
- **智谱清言优化**: 优化智谱清言大模型API的响应速度

### 技术改进 🔧
- **API架构重构**: 重构API配置架构，支持双路API模型
- **代码优化**: 优化网络请求代码，提升API调用效率
- **性能优化**: 减少流式输出模拟延迟，提升用户体验

### 界面优化 🎨
- **API配置界面升级**: 重构API配置界面，支持双路API配置
- **视觉统一**: 统一应用内所有查询相关功能的图标为AutoAwesome（三个星星）图标

## [4.8.0] - 2025-07-25

### 界面优化 🎨
- **单词本筛选菜单全面升级**: 将右上角收藏心形图标替换为汉堡菜单图标，点击后滑出功能丰富的筛选侧边栏
- **智能筛选功能**: 新增收藏筛选、记录时间排序、拼写次数排序、浏览次数排序等多维度筛选选项
- **流畅动画效果**: 侧边菜单支持300ms平滑滑入滑出动画，汉堡图标与叉叉图标无缝切换
- **精致视觉设计**: 侧边菜单采用与底部导航栏一致的背景色，视觉更加统一协调

### 图标统一化 ✨
- **三个星星图标统一**: 将所有查询相关功能的图标统一为AutoAwesome（三个星星）图标
- **查单词首页优化**: 查询按钮前的放大镜图标替换为三个星星图标，与底部导航栏保持一致
- **小组件图标升级**: 小组件搜索按钮和弹出查询卡片的图标全部更新为三个星星图标
- **视觉一致性提升**: 整个应用的查询功能现在使用统一的视觉语言

### 用户体验改进 💡
- **筛选菜单交互优化**: 收藏筛选状态显示在同一行右侧，排序选项去掉冒号并右对齐显示
- **图标大小精调**: 收藏筛选心形图标减小15%，排序箭头图标加大35%，视觉层次更清晰
- **布局紧凑化**: 侧边菜单宽度优化为215dp，统计数据位置上移，界面更加紧凑高效
- **选中状态优化**: 排序选项选中时图标加大但行高保持不变，避免界面跳动

### 技术改进 🔧
- **数据库排序支持**: 在WordDao中新增多种排序方式的分页查询方法，支持所有筛选组合
- **状态管理完善**: 在ViewModel中添加排序状态管理，确保筛选状态与UI完全同步
- **组件化设计**: 新增FilterSideMenu组件，支持动画效果和完整的筛选逻辑

### 修复问题 🐛
- 修复了小组件点击搜索按钮后立刻关闭的问题
- 修复了小组件查询按钮图标颜色、位置和间距问题
- 修复了排序项目X轴对齐和行高一致性问题

## [4.7.0] - 2025-07-25

### 功能改进 💡
- **系统代码清理**: 优化了项目代码结构，提升了代码质量和可维护性
- **导入功能优化**: 改进了数据导入功能的稳定性和用户体验

### 技术改进 🔧
- **状态管理优化**: 新增导出数据状态管理，确保导出路径信息的正确显示
- **UI组件重构**: 重构了数据管理界面，提升了用户交互体验

## [4.6.0] - 2025-07-24

### 功能改进 💡
- **智能中文释义解析**: 优化中文释义的解析时机，确保释义部分完全输出后才进行解析和显示
- **关键词检测机制**: 通过检测"音标"关键词来判断流式输出是否完成，避免过早显示错误提示
- **流畅的UI状态管理**: 流式输出进行中时隐藏中文释义区域，完成后再显示解析结果

### 界面优化 🎨
- **动态显示控制**: 中文释义区域根据流式状态智能显示或隐藏
- **错误提示优化**: 只在确认解析失败后才显示错误提示，避免误导用户
- **视觉连贯性**: 流式输出过程中保持界面的视觉连贯性和稳定性
- **响应式反馈**: 提供更准确和及时的用户反馈机制

### 技术改进 🔧
- **WidgetUIStateManager优化**: 增强了`updateChineseMeaning_7ree`方法，添加流式状态参数控制
- **内容完整性检测**: 新增`isContentComplete_7ree`方法，智能判断流式输出完成状态
- **参数传递优化**: 改进了流式输出处理逻辑，正确传递完整内容和状态信息
- **状态同步机制**: 确保UI状态与流式输出进度完美同步

### 修复问题 🐛
- 修复了流式输出时过早显示"(无法解析中文释义)"的问题
- 修复了中文释义解析时机不准确的问题
- 修复了UI状态与流式输出进度不同步的问题

## [4.5.0] - 2025-07-23

### 新增功能 ✨
- **局域网数据管理**: 全新推出电脑操作功能，通过局域网在PC端进行数据导入导出操作
- **Web界面操作**: 精美的PC端Web界面，支持文件导入和手动粘贴JSON数据两种导入方式
- **跨平台数据同步**: PC端和手机端数据实时同步，导入成功后自动更新单词记录数量显示
- **智能操作模式**: 手机操作与电脑操作互斥切换，避免操作冲突，确保数据安全

### 界面优化 🎨
- **前台查询卡片优化升级**: 优化前台查询卡片的视觉设计，界面更加精美协调
- **响应速度优化**: 提升查询卡片的响应速度，操作更加流畅自然
- **交互体验改进**: 改进用户交互逻辑，减少操作步骤，提升使用效率
- **视觉一致性**: 统一设计语言，与应用整体风格保持高度一致

### 技术改进 🔧
- **模块化HTTP服务器**: 将复杂的HTTP服务器代码拆分为多个独立组件，便于维护和扩展
- **组件化UI设计**: 数据管理界面采用组件化设计，代码结构更加清晰
- **状态管理优化**: 改进状态管理机制，确保跨组件状态同步的准确性
- **版本管理自动化**: 实现版本信息的自动化管理，减少手动维护工作量

## [1.0.0] - 2025-07-13

### 新增功能 ✨
- 🎉 首次发布 WordCard AI 智能单词卡片应用
- 🤖 集成 OpenAI GPT 模型，提供智能单词查询
- 🎵 支持单词和例句的 TTS 语音朗读
- 📚 单词历史记录管理和收藏功能
- 📱 基于 Jetpack Compose 的现代化 UI 界面
- 🎨 Material Design 3 设计语言支持
- 📊 学习进度统计功能
- 📤 数据导入导出功能（JSON 格式）
- 👆 手势导航，支持上下滑动切换单词
- 🌙 深色/浅色主题支持

### 技术特性 🔧
- 使用 Kotlin + Jetpack Compose 开发
- MVVM 架构模式
- Room 数据库本地存储
- Ktor 网络请求库
- Markwon Markdown 渲染
- Kotlinx Serialization 数据序列化

### 系统要求 📋
- Android 6.0 (API 24) 或更高版本
- 需要 OpenAI API 密钥
- 支持 TTS 语音功能

### 已知问题 ⚠️
- 首次使用需要配置 OpenAI API 密钥
- 需要网络连接才能使用 AI 查询功能
- TTS 功能需要设备支持相应语言包

---

## 版本说明

### 版本号格式
- `主版本号.次版本号.修订号`
- 例如：`1.0.0`

### 版本类型
- **主版本号**：不兼容的 API 修改
- **次版本号**：向下兼容的功能性新增
- **修订号**：向下兼容的问题修正

### 更新类型标识
- ✨ 新功能
- 🐛 Bug 修复
- 💡 功能改进
- 📝 文档更新
- 🎨 界面优化
- ⚡ 性能优化
- 🔧 技术改进
- ⚠️ 已知问题
- 🚀 重大更新

---

## 贡献更新日志

如果您为项目添加了新功能或修复了 Bug，请在提交 PR 时更新此文件，添加相应的更新日志条目。

### 更新日志格式

```markdown
## [版本号] - YYYY-MM-DD

### 新增功能 ✨
- 功能描述

### 修复问题 🐛
- 问题描述

### 功能改进 💡
- 改进描述
```

---

## 历史版本

### [0.1.0] - 开发版本
- 项目初始化和基础架构搭建
- 核心功能开发和测试
- UI 界面设计和实现
